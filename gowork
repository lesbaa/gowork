#!/bin/bash
# rather than footer about with opening apps etc, this bash
# script simply opens the appropriate apps at the appropriate place

openApps=''

DIR="$( cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null && pwd )"

while getopts "sfcpm:" opt; do
  case $opt in
    s) openApps="open -a Spotify;$openApps";;
    f) openApps="open -a Firefox\ Developer\ Edition;$openApps";;
    c) openApps="open -a Google\ Chrome;$openApps";;
    p) openApps="open -a Postman;$openApps";;
    m) openApps="open -a MongoDB\ Compass\ Community;$openApps";;
    \?) echo "ğŸ’£  Invalid option: -$opt";;
  esac
done; shift $(( OPTIND - 1 ))

siteDir=~/Sites/$1

echo "ğŸ“‚  Attempting to open \"$1\" directory..."

function openStuff {
  echo 'ğŸ‘¨â€ğŸ’»  Opening iTerm and setting up sessions...'
  osascript $DIR/gowork.applescript "$siteDir" && # automates the iTerm side of things

  cd $siteDir &&

  echo 'ğŸ‘©ğŸ¼â€ğŸ’»  Opening VsCode...'
  code . &&
  echo 'âš¡ï¸  Opening other apps...'
  eval $openApps &&
  echo 'ğŸ‰  Done!'
}

if [ -e $siteDir ]; then
  openStuff;
else
  echo "ğŸ¤¦ğŸ½â€  Uh Oh! directory \"$1\" does not exist in ~/Sites, create it? (y/n)"
  read answer
  if [ $answer == 'y' ]; then
    echo 'ğŸ“  Creating directory...'
    mkdir $siteDir
    openStuff;
  else
    echo 'ğŸ‘‹ğŸ½  Okay then, by for now.'
  fi
fi
